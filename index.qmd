---
title: "Final Project"
format:
  dashboard:
    orientation: columns
    theme: cosmo
    css: style.css
---

```{r, echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(plotly)
library(janitor)
library(dplyr)

accessories <- read_csv("data/accessories.csv")

accessories <- accessories %>%
  clean_names()

accessories <- accessories %>% 
  distinct(name, .keep_all = TRUE)

#cite data, add sentences
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
p1 <- ggplot(accessories, aes(x = sell)) +
  geom_histogram(bins = 30) +
  labs(
    title = "Distribution of Accessory Prices",
    x = "Price",
    y = "Count"
  ) +
  theme_minimal()

ggplotly(p1)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
p_dot <- accessories %>%
  arrange(sell) %>%
  mutate(name = fct_reorder(name, sell)) %>%
  ggplot(aes(x = sell, y = name)) +
  geom_point(alpha = 0.6) +
  labs(
    title = "Accessory Prices",
    x = "Price",
    y = "Accessory"
  ) +
  theme_minimal() +
  theme(
    axis.text.y = element_blank(),
    axis.ticks.y = element_blank()
  ) 


ggplotly(p_dot)

```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
top_n <- accessories %>%
  slice_max(sell, n = 20)

p_top <- ggplot(top_n, aes(x = sell, y = fct_reorder(name, sell))) +
  geom_point(size = 3) +
  labs(
    title = "Top 20 Most Expensive Accessories",
    x = "Price",
    y = "Accessory"
  ) +
  theme_minimal()

ggplotly(p_top)


```
